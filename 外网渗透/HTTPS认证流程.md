HTTPS认证流程

HTTPS单向认证



1.客户端向服务器发起请求，其中包括各种SSL参数，并从服务器端拿到证书。



2.客户端将从服务器端获得的证书提交至CA，CA验证证书的合法性并告知客户端，客户端根据CA验证结果来确认目标站点的真实性。



3.从服务器端的证书中取出公钥，利用公钥对客户端产生的密钥加密（对称密钥），并利用公钥将加密后的密钥发送到服务器端。



4.服务端用其私钥解密出数据，即得到客户端发送来的对称密钥，之后均利用这个对称密钥对传输文件进行加密/解密。



SSL strip劫持



如果HTTPS变成HTTP，需要格外注意。

HTTPS双向认证



1.客户端向服务器发起请求，其中包括各种SSL参数，并从服务器端拿到证书。



2.客户端将从服务器端获得的证书提交至CA，CA验证证书的合法性并告知客户端，客户端根据CA验证结果来确认目标站点的真实性。



a.服务端要求客户端发送证书并验证，并接受用户的公钥。



b.双方利用对方公钥加密来协商可支持的传输类型及密码方案。



3.从服务器端的证书中取出公钥，利用公钥对客户端产生的密钥加密（对称密钥），并利用公钥将加密后的密钥发送到服务器端。



4.服务端用其私钥解密出数据，即得到客户端发送来的对称密钥，之后均利用这个对称密钥对传输文件进行加密/解密。



注：由于客户端没有针对特定网站的密钥生成机制，因此在双向认证时站点会要求客户端安装特定的插件，用来实现密钥的生成。